ボトムアップでわかる

- 最低限の構成
  - 値オブジェクト
  - エンティティ
  - ドメインサービス
  - リポジトリ

## 値オブジェクト

プリミティブ型は汎用性が高すぎるため、値オブジェクトを定義してドメインモデルに適したものにする

- 値とは
  - 不変
  - 交換可能
    - 値を直接操作して代入するのではなく、交換という振る舞いを定義する
  - 等価性によって比較される

- VOをバンバン作ってクラスを量産することは、DDDに慣れていない多くの開発者にとって心理的ハードルが高い
  - モチベーションが必要

## エンティティ

ドメインモデルを実装したドメインオブジェクト

- 可変
- 同じ属性であっても区別される
- 同一性によって区別される
  - IDなど

- エンティティの判断基準
  - ライフサイクルがある
    - ライフサイクルがあってもVOとして扱うべきものもあるので、そこは要注意

## ドメインサービス

値オブジェクト、エンティティとして振る舞いを定義するには不自然なもの

- サービスとはなにか
  - クライアントのために何かを行うオブジェクト
    - ドメインのためサービス
      - ドメインサービス
    - アプリケーションのためのサービス
      - アプリケーションサービス

- ドメインモデル貧血症
  - 処理をドメインサービスに移動しすぎて、ドメインモデルにほとんど振る舞いが記述されていない状態
    - やろうと思えばドメインサービスに全ての処理を移動できるため、注意が必要
  - ↑身に覚えがある…

- 可能なかぎり、ドメインオブジェクトに処理を寄せる

## リポジトリ

オブジェクトの永続化、再構築を行う

- ドメインオブジェクトではないが、ドメインオブジェクトを際立たせる
  - リポジトリは責務が明確なので、リポジトリ層を導入するだけでだいぶスッキリする
    - サービス層より責務が明確

## アプリケーションサービス

ドメインオブジェクトをまとめあげてユースケースを構築する

- アプリケーションサービスからドメインオブジェクトを返却したい時は、DTO(Data Transfer Object)を使うと良い

## 集約

データ変更の単位。ルートオブジェクトが存在し、データの変更はルートオブジェクトから行われる

- 集約の切り方は難しいトピックの一つ
